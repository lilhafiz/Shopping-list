<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CSC456t</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" />
  </head>
  <body>
    <div class="container mt-5">
      <h1>BrotherHoodShopping List</h1>
      <ul id="shoppingList" class="list-group">
        {% for item in shopping_list %}
          <li class="list-group-item" onclick="removeItem(this)">{{ item }}</li>
        {% endfor %}
      </ul>
      <form method="POST" action="{{ url_for('add_item') }}" class="mt-3">
        <div class="form-group">
          <label for="item">Add Item:</label>
          <input type="text" class="form-control" id="item" name="item" required />
        </div>
        <button type="submit" class="btn btn-primary">Add to List</button>
        <button type="button" class="btn btn-danger" onclick="clearList()">Clear List</button>
      </form>
    </div>

    <script>
      function removeItem(itemElement) {
        const itemName = itemElement.innerText
      
        // Use JavaScript to remove the clicked item from the shopping list
        fetch('/remove-item', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ item: itemName })
        })
          .then((response) => response.json())
          .then((data) => {
            if (data.success) {
              // Remove the item from the list
              itemElement.remove()
            } else {
              console.error('Failed to remove the item.')
            }
          })
          .catch((error) => console.error('Error removing the item:', error))
      }
      
      function clearList() {
        // Use JavaScript to clear the shopping list
        fetch('/clear-list', { method: 'POST' })
          .then((response) => response.json())
          .then((data) => {
            if (data.success) {
              // Reload the page to reflect the cleared list
              location.reload()
            } else {
              console.error('Failed to clear the list.')
            }
          })
          .catch((error) => console.error('Error clearing the list:', error))
      }
    </script>
  </body>
</html>
